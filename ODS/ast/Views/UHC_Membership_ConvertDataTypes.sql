CREATE ViEW ast.UHC_Membership_ConvertDataTypes
AS 
SELECT top 10000
    URN      
      ,RTRIM(LTRIM([MEDICAID_ID]))AS[MEDICAID_ID]	
      ,RTRIM(LTRIM([MEMBER_LAST_NAME]))AS [MEMBER_LAST_NAME]
      ,RTRIM(LTRIM([MEMBER_FIRST_NAME]))AS [MEMBER_FIRST_NAME]
      ,TRY_CONVERT(DATE, RTRIM(LTRIM([DATE_OF_BIRTH])),101) AS [DATE_OF_BIRTH]
      ,TRY_CONVERT(NUMERIC(5,2), RTRIM(LTRIM([IPRO_ADMIT_RISK_SCORE])))AS [IPRO_ADMIT_RISK_SCORE]
      ,RTRIM(LTRIM([UHC_SUBSCRIBER_ID]))AS [UHC_SUBSCRIBER_ID]
      ,RTRIM(LTRIM([UHC_UNIQUE_SYSTEM_ID]))AS [UHC_UNIQUE_SYSTEM_ID]
      ,RTRIM(LTRIM([MEMBER_ADDRESS]))AS [MEMBER_ADDRESS]
      ,RTRIM(LTRIM([MEMBER_CITY]))AS [MEMBER_CITY]
      ,RTRIM(LTRIM([MEMBER_STATE]))AS [MEMBER_STATE]
      ,RTRIM(LTRIM([MEMBER_COUNTY]	))AS [MEMBER_COUNTY]
      ,RTRIM(LTRIM([MEMBER_ZIP]				))AS [MEMBER_ZIP]
      ,RTRIM(LTRIM([MEMBER_PHONE]				))AS [MEMBER_PHONE]
      ,RTRIM(LTRIM([LINE_OF_BUSINESS]			))AS [LINE_OF_BUSINESS]
      ,RTRIM(LTRIM([PLAN_CODE]				))AS [PLAN_CODE]
      ,RTRIM(LTRIM([PLAN_DESC]				))AS [PLAN_DESC]
      ,RTRIM(LTRIM([REGION_CODE]				))AS [REGION_CODE]
      ,RTRIM(LTRIM([REGION_DESC]				))AS [REGION_DESC]
      ,RTRIM(LTRIM([PCP_NAME]					))AS [PCP_NAME]
      ,RTRIM(LTRIM([PCP_ADDRESS]				))AS [PCP_ADDRESS]
      ,RTRIM(LTRIM([PCP_CITY]					))AS [PCP_CITY]
      ,RTRIM(LTRIM([PCP_STATE]				))AS [PCP_STATE]
      ,RTRIM(LTRIM([PCP_COUNTY]				))AS [PCP_COUNTY]
      ,RTRIM(LTRIM([PCP_ZIP]					))AS [PCP_ZIP]
      ,RTRIM(LTRIM([PCP_PRACTICE_TIN]			))AS [PCP_PRACTICE_TIN]
      ,RTRIM(LTRIM([PCP_PRACTICE_NAME]			))AS [PCP_PRACTICE_NAME]
      ,RTRIM(LTRIM([PRIMARY_RISK_FACTOR]		))AS [PRIMARY_RISK_FACTOR]
	 ,try_CONVERT(Numeric(16,2), REPLACE(REPLACE(REPLACE(TOTAL_COSTS_LAST_12_MOS, ' ',''),'$', ''), ',', '')) AS [TOTAL_COSTS_LAST_12_MOS]
	 ,try_CONVERT(smallint, [COUNT_OPEN_CARE_OPPS]) AS [COUNT_OPEN_CARE_OPPS]
	 ,try_CONVERT(Numeric(16,2), REPLACE(REPLACE(REPLACE([INP_COSTS_LAST_12_MOS], ' ',''),'$', ''), ',', '')) AS [INP_COSTS_LAST_12_MOS2] 
      ,try_CONVERT(Numeric(16,2), REPLACE(REPLACE(REPLACE([ER_COSTS_LAST_12_MOS], ' ',''),'$', ''), ',', '')) AS [ER_COSTS_LAST_12_MOS]
	 ,try_CONVERT(Numeric(16,2), REPLACE(REPLACE(REPLACE([OUTP_COSTS_LAST_12_MOS], ' ',''),'$', ''), ',', '')) AS [OUTP_COSTS_LAST_12_MOS]      
      ,try_CONVERT(Numeric(16,2), REPLACE(REPLACE(REPLACE([PHARMACY_COSTS_LAST_12_MOS], ' ',''),'$', ''), ',', '')) AS [PHARMACY_COSTS_LAST_12_MOS]
      ,try_CONVERT(Numeric(16,2), REPLACE(REPLACE(REPLACE([PRIMARY_CARE_COSTS_LAST_12_MOS], ' ',''),'$', ''), ',', '')) AS [PRIMARY_CARE_COSTS_LAST_12_MOS]	 
      ,try_CONVERT(Numeric(16,2), REPLACE(REPLACE(REPLACE([BEHAVIORAL_COSTS_LAST_12_MOS], ' ',''),'$', ''), ',', '')) AS [BEHAVIORAL_COSTS_LAST_12_MOS]	 
      ,try_CONVERT(Numeric(16,2), REPLACE(REPLACE(REPLACE([OTHER_OFFICE_COSTS_LAST_12_MOS], ' ',''),'$', ''), ',', '')) AS [OTHER_OFFICE_COSTS_LAST_12_MOS]
	 ,try_CONVERT(smallint, [INP_ADMITS_LAST_12_MOS]) AS [INP_ADMITS_LAST_12_MOS]     
	 ,TRY_PARSE(RTRIM(LTRIM([LAST_INP_DISCHARGE])) AS date USING 'en-US')  AS [LAST_INP_DISCHARGE]      
      ,TRY_PARSE(RTRIM(LTRIM([POST_DISCHARGE_FUP_VISIT])) AS date USING 'en-US')  AS [POST_DISCHARGE_FUP_VISIT] 
      ,CONVERT(VARCHAR(20), RTRIM(LTRIM([INP_FUP_WITHIN_7_DAYS])))AS [INP_FUP_WITHIN_7_DAYS]
      ,try_CONVERT(smallint, [ER_VISITS_LAST_12_MOS]) AS [ER_VISITS_LAST_12_MOS] 
	 ,TRY_PARSE(RTRIM(LTRIM([LAST_ER_VISIT])) AS date USING 'en-US')  AS [LAST_ER_VISIT]
      ,TRY_PARSE(RTRIM(LTRIM([POST_ER_FUP_VISIT]))AS date USING 'en-US')  AS [POST_ER_FUP_VISIT] 
      ,CONVERT(VARCHAR(20), RTRIM(LTRIM([ER_FUP_WITHIN_7_DAYS]))) AS [ER_FUP_WITHIN_7_DAYS] 
      ,TRY_PARSE(RTRIM(LTRIM([LAST_PCP_VISIT])) AS date USING 'en-US')  AS [LAST_PCP_VISIT] 
      ,CONVERT(VARCHAR(100), RTRIM(LTRIM([LAST_PCP_PRACTICE_SEEN]))) AS [LAST_PCP_PRACTICE_SEEN] 
      ,TRY_PARSE(RTRIM(LTRIM([LAST_BH_VISIT])) AS date USING 'en-US')  AS [LAST_BH_VISIT]
      ,CONVERT(VARCHAR(100), RTRIM(LTRIM([LAST_BH_PRACTICE_SEEN]))) AS [LAST_BH_PRACTICE_SEEN]      
	 , TRY_CONVERT(smallint, MEMBER_MONTH_COUNT) AS MEMBER_MONTH_COUNT
	 , TRY_PARSE(RTRIM(LTRIM(FILE_GENERATION_DATE)) AS date USING 'en-US') AS FILE_GENERATION_DATE
	 , TRY_CONVERT(smallint, REPLACE(RTRIM(LTRIM(replace(REPORT_MONTH, ' ', Null))),'',null)) AS REPORT_MONTH 
	 , A_LAST_UPDATE_DATE
	 , A_LAST_UPDATE_BY
	 , A_LAST_UPDATE_FLAG
  FROM [dbo].[UHC_Membership]
